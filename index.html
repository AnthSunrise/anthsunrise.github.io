<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L2 Risen - Material Calculator & Rebirth Requirements</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #1c1c1c;
            color: #e0e0e0;
            padding: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        h1 {
            color: #4d9fff;
            text-align: center;
            margin-bottom: 10px;
            border-bottom: 2px solid #2a5caa;
            padding-bottom: 15px;
        }
        
        h2 {
            color: #6ab7ff;
            margin-top: 30px;
            border-left: 4px solid #2a5caa;
            padding-left: 10px;
        }
        
        .tab-container {
            margin-bottom: 25px;
        }
        
        .tabs {
            display: flex;
            background-color: #16213e;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
            border: 1px solid #2a5caa;
        }
        
        .tab {
            padding: 15px 25px;
            background-color: #0f3460;
            border-right: 1px solid #2a5caa;
            cursor: pointer;
            font-weight: bold;
            color: #a3d0ff;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }
        
        .tab:hover {
            background-color: #1a3a6a;
            color: #ffffff;
        }
        
        .tab.active {
            background-color: #2a5caa;
            color: #ffffff;
            border-bottom: 3px solid #4d9fff;
        }
        
        .tab-content {
            display: none;
            background-color: #16213e;
            padding: 20px;
            border-radius: 0 0 10px 10px;
            border: 1px solid #2a5caa;
            border-top: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Estilos existentes para la calculadora */
        .controls {
            background-color: #16213e;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            border: 1px solid #2a5caa;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            min-width: 250px;
        }
        
        label {
            margin-bottom: 8px;
            color: #a3d0ff;
            font-weight: bold;
        }
        
        select {
            padding: 10px;
            border-radius: 5px;
            background-color: #0f3460;
            color: white;
            border: 1px solid #2a5caa;
            font-size: 14px;
        }
        
        select:focus {
            outline: none;
            border-color: #4d9fff;
            box-shadow: 0 0 5px rgba(77, 159, 255, 0.5);
        }
        
        .tier-info {
            background-color: #0f3460;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 14px;
            border-left: 4px solid #4d9fff;
            flex: 1;
            max-width: 400px;
        }
        
        .results-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        
        .table-container {
            flex: 1;
            min-width: 300px;
            background-color: #16213e;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #2a5caa;
        }
        
        .table-container h3 {
            background-color: #0f3460;
            margin: 0;
            padding: 15px;
            color: #a3d0ff;
            border-bottom: 1px solid #2a5caa;
        }
        
        .table-container h3.grade-d {
            border-left: 5px solid #4CAF50;
        }
        
        .table-container h3.grade-c {
            border-left: 5px solid #2196F3;
        }
        
        .table-container h3.grade-b {
            border-left: 5px solid #9C27B0;
        }
        
        .table-container h3.grade-a {
            border-left: 5px solid #FF9800;
        }
        
        .table-container h3.grade-s {
            border-left: 5px solid #FF5722;
        }
        
        .table-container h3.grade-dynasty {
            border-left: 5px solid #FFD700;
        }
        
        .table-container h3.grade-moirai {
            border-left: 5px solid #FF4081;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background-color: #1a3a6a;
            padding: 12px 10px;
            text-align: left;
            color: #a3d0ff;
            font-weight: bold;
        }
        
        td {
            padding: 10px;
            border-bottom: 1px solid #2a5caa;
        }
        
        tr:nth-child(even) {
            background-color: rgba(15, 52, 96, 0.3);
        }
        
        tr:hover {
            background-color: rgba(77, 159, 255, 0.1);
        }
        
        .material-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .material-icon {
            width: 32px;
            height: 32px;
            border-radius: 4px;
            border: 1px solid #2a5caa;
            background-color: #0f3460;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #a3d0ff;
            flex-shrink: 0;
        }
        
        .material-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 3px;
        }
        
        .material-name {
            font-weight: bold;
            color: #d1e7ff;
        }
        
        .material-count {
            text-align: right;
            font-family: monospace;
            font-size: 16px;
            color: #ffffff;
        }
        
        .total-row {
            background-color: rgba(26, 58, 106, 0.8) !important;
            font-weight: bold;
            color: #ffffff;
        }
        
        .grade-total {
            background-color: #1a3a6a;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 15px;
            display: inline-block;
            font-weight: bold;
            color: #ffffff;
        }
        
        .instructions {
            background-color: rgba(15, 52, 96, 0.5);
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 4px solid #4d9fff;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .highlight {
            color: #FFD700;
            font-weight: bold;
        }
        
        .remaining-info {
            color: #FF9800;
            font-weight: bold;
        }
        
        .image-info {
            background-color: rgba(15, 52, 96, 0.3);
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 13px;
            color: #a3d0ff;
        }
        
        .grade-summary {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .grade-card {
            background-color: #16213e;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #2a5caa;
            min-width: 200px;
            flex: 1;
        }
        
        .grade-card.d {
            border-left: 5px solid #4CAF50;
        }
        
        .grade-card.c {
            border-left: 5px solid #2196F3;
        }
        
        .grade-card.b {
            border-left: 5px solid #9C27B0;
        }
        
        .grade-card.a {
            border-left: 5px solid #FF9800;
        }
        
        .grade-card.s {
            border-left: 5px solid #FF5722;
        }
        
        .grade-card.dynasty {
            border-left: 5px solid #FFD700;
        }
        
        .grade-card.moirai {
            border-left: 5px solid #FF4081;
        }
        
        .grade-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 10px;
            color: #d1e7ff;
        }
        
        .grade-stats {
            font-size: 14px;
            color: #a3d0ff;
        }
        
        /* Estilos para la lista de Rebirth */
        .rebirths-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .rebirth-card {
            background-color: #16213e;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #2a5caa;
            transition: transform 0.3s ease;
        }
        
        .rebirth-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .rebirth-title {
            font-size: 20px;
            font-weight: bold;
            color: #4d9fff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #2a5caa;
            text-align: center;
        }
        
        .rebirth-material {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(42, 92, 170, 0.3);
        }
        
        .rebirth-material:last-child {
            border-bottom: none;
        }
        
        .rebirth-material-name {
            font-weight: bold;
            color: #d1e7ff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rebirth-material-count {
            font-family: monospace;
            font-size: 16px;
            color: #ffffff;
            background-color: #0f3460;
            padding: 3px 10px;
            border-radius: 4px;
            min-width: 100px;
            text-align: right;
        }
        
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-right: none;
                border-bottom: 1px solid #2a5caa;
            }
            
            .rebirths-container {
                grid-template-columns: 1fr;
            }
            
            .results-container {
                flex-direction: column;
            }
            
            .controls {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .control-group {
                width: 100%;
            }
            
            .grade-summary {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <h1><i class="fas fa-shield-alt"></i> L2 RisenWorlds - Material Calculator & Rebirth Requirements</h1>
    
    <div class="tab-container">
        <div class="tabs">
            <div class="tab active" data-tab="calculator">Armor Calculator</div>
            <div class="tab" data-tab="rebirth">Rebirth Requirements</div>
        </div>
        
        <div id="calculator-tab" class="tab-content active">
            <div class="controls">
                <div class="control-group">
                    <label for="targetSelect"><i class="fas fa-bullseye"></i> Objetivo a alcanzar:</label>
                    <select id="targetSelect">
                        <option value="all">Todas las armaduras (D → Moirai)</option>
                        <option value="grade-d">Solo grado D (Tier 1-2)</option>
                        <option value="grade-c">Hasta grado C (Tier 1-3)</option>
                        <option value="grade-b">Hasta grado B (Zubei, Avadon, Blue Wolf, Doom)</option>
                        <option value="grade-a">Hasta grado A (Dark Crystal, Tallum, Nightmare, Majestic)</option>
                        <option value="grade-s">Hasta grado S</option>
                        <option value="grade-dynasty">Hasta Dynasty</option>
                        <option value="grade-moirai">Hasta Moirai</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="currentArmorSelect"><i class="fas fa-user"></i> Armadura que ya tengo:</label>
                    <select id="currentArmorSelect">
                        <option value="none">No tengo ninguna (comenzar desde 0)</option>
                        <optgroup label="Grado D">
                            <option value="D-T1-L1">Grado D - Tier 1 - Lv 1</option>
                            <option value="D-T1-L2">Grado D - Tier 1 - Lv 2</option>
                            <option value="D-T1-L3">Grado D - Tier 1 - Lv 3</option>
                            <option value="D-T2-L1">Grado D - Tier 2 - Lv 1</option>
                            <option value="D-T2-L2">Grado D - Tier 2 - Lv 2</option>
                            <option value="D-T2-L3">Grado D - Tier 2 - Lv 3</option>
                        </optgroup>
                        <optgroup label="Grado C">
                            <option value="C-T1-L1">Grado C - Tier 1 - Lv 1</option>
                            <option value="C-T1-L2">Grado C - Tier 1 - Lv 2</option>
                            <option value="C-T1-L3">Grado C - Tier 1 - Lv 3</option>
                            <option value="C-T2-L1">Grado C - Tier 2 - Lv 1</option>
                            <option value="C-T2-L2">Grado C - Tier 2 - Lv 2</option>
                            <option value="C-T2-L3">Grado C - Tier 2 - Lv 3</option>
                            <option value="C-T3-L1">Grado C - Tier 3 - Lv 1</option>
                            <option value="C-T3-L2">Grado C - Tier 3 - Lv 2</option>
                            <option value="C-T3-L3">Grado C - Tier 3 - Lv 3</option>
                        </optgroup>
                        <optgroup label="Grado B">
                            <option value="B-Zubei-L1">Grado B - Zubei - Lv 1</option>
                            <option value="B-Zubei-L2">Grado B - Zubei - Lv 2</option>
                            <option value="B-Zubei-L3">Grado B - Zubei - Lv 3</option>
                            <option value="B-Avadon-L1">Grado B - Avadon - Lv 1</option>
                            <option value="B-Avadon-L2">Grado B - Avadon - Lv 2</option>
                            <option value="B-Avadon-L3">Grado B - Avadon - Lv 3</option>
                            <option value="B-BlueWolf-L1">Grado B - Blue Wolf - Lv 1</option>
                            <option value="B-BlueWolf-L2">Grado B - Blue Wolf - Lv 2</option>
                            <option value="B-BlueWolf-L3">Grado B - Blue Wolf - Lv 3</option>
                            <option value="B-Doom-L1">Grado B - Doom - Lv 1</option>
                            <option value="B-Doom-L2">Grado B - Doom - Lv 2</option>
                            <option value="B-Doom-L3">Grado B - Doom - Lv 3</option>
                        </optgroup>
                        <optgroup label="Grado A">
                            <option value="A-DarkCrystal-L1">Grado A - Dark Crystal - Lv 1</option>
                            <option value="A-DarkCrystal-L2">Grado A - Dark Crystal - Lv 2</option>
                            <option value="A-DarkCrystal-L3">Grado A - Dark Crystal - Lv 3</option>
                            <option value="A-Tallum-L1">Grado A - Tallum - Lv 1</option>
                            <option value="A-Tallum-L2">Grado A - Tallum - Lv 2</option>
                            <option value="A-Tallum-L3">Grado A - Tallum - Lv 3</option>
                            <option value="A-Nightmare-L1">Grado A - Nightmare - Lv 1</option>
                            <option value="A-Nightmare-L2">Grado A - Nightmare - Lv 2</option>
                            <option value="A-Nightmare-L3">Grado A - Nightmare - Lv 3</option>
                            <option value="A-Majestic-L1">Grado A - Majestic - Lv 1</option>
                            <option value="A-Majestic-L2">Grado A - Majestic - Lv 2</option>
                            <option value="A-Majestic-L3">Grado A - Majestic - Lv 3</option>
                        </optgroup>
                        <optgroup label="Grado S">
                            <option value="S-L1">Grado S - Lv 1</option>
                            <option value="S-L2">Grado S - Lv 2</option>
                            <option value="S-L3">Grado S - Lv 3</option>
                        </optgroup>
                        <optgroup label="Grado Dynasty">
                            <option value="Dynasty-L1">Grado Dynasty - Lv 1</option>
                            <option value="Dynasty-L2">Grado Dynasty - Lv 2</option>
                            <option value="Dynasty-L3">Grado Dynasty - Lv 3</option>
                        </optgroup>
                        <optgroup label="Grado Moirai">
                            <option value="moirai-full">Set Moirai Completo</option>
                        </optgroup>
                    </select>
                </div>
                
                <div class="tier-info">
                    <strong><i class="fas fa-layer-group"></i> Progresión de armaduras:</strong><br>
                    <strong>D:</strong> Tier 1 → Tier 2<br>
                    <strong>C:</strong> Tier 1 → Tier 2 → Tier 3<br>
                    <strong>B:</strong> Zubei → Avadon → Blue Wolf → Doom<br>
                    <strong>A:</strong> Dark Crystal → Tallum → Nightmare → Majestic<br>
                    <strong>S:</strong> Grado S (Armor/Helmet/Gloves/Boots)<br>
                    <strong>Dynasty:</strong> Armadura final<br>
                    <strong>Moirai:</strong> Set completo (Helmet, Armor, Pants, Glove, Shoes)
                </div>
            </div>
            
            <div id="summaryContainer" class="grade-summary">
                <!-- Resumen por grado se generará aquí -->
            </div>
            
            <h2><i class="fas fa-calculator"></i> Materiales Requeridos</h2>
            
            <div class="results-container" id="resultsContainer">
                <!-- Los resultados se generarán aquí con JavaScript -->
            </div>
        </div>
        
        <div id="rebirth-tab" class="tab-content">
            <h2><i class="fas fa-redo-alt"></i> Rebirth Requirements List</h2>
            <div class="rebirths-container" id="rebirthsContainer">
                <!-- Los rebirths se generarán aquí con JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Datos de los rebirths
        const rebirthData = [
            {
                id: 1,
                title: "Rebirth 1",
                materials: [
                    { name: "Coal", count: 1500 },
                    { name: "Animal Bone", count: 5000 },
                    { name: "Animal Skin", count: 5000 },
                    { name: "Enchant Armor D", count: 10 }
                ]
            },
            {
                id: 2,
                title: "Rebirth 2",
                materials: [
                    { name: "Dyes STR +1 CON -1", count: 100 },
                    { name: "Enchant Weapon C", count: 50 },
                    { name: "Scroll EXP 20% (1 hour)", count: 1 }
                ]
            },
            {
                id: 3,
                title: "Rebirth 3",
                materials: [
                    { name: "Adena", count: 25000000 },
                    { name: "Stem", count: 10000 },
                    { name: "Ritron Jelly", count: 1 },
                    { name: "Wish Potion", count: 1 }
                ]
            },
            {
                id: 4,
                title: "Rebirth 4",
                materials: [
                    { name: "Adena", count: 30000000 },
                    { name: "Gold Wyvern", count: 400 },
                    { name: "Blood Medusa", count: 400 },
                    { name: "Silver Unicorn", count: 400 },
                    { name: "Manticore Skin Boot Lining", count: 2 },
                    { name: "Brigandine Helmet Design", count: 2 },
                    { name: "Mithril Gloves Design", count: 50 }
                ]
            },
            {
                id: 5,
                title: "Rebirth 5",
                materials: [
                    { name: "Adena", count: 35000000 },
                    { name: "Gold Wyvern", count: 400 },
                    { name: "Blood Medusa", count: 400 },
                    { name: "Silver Unicorn", count: 400 },
                    { name: "Full Plate Shield +6", count: 1 },
                    { name: "Bonebreaker head", count: 1 },
                    { name: "Heavy Bone Club Head", count: 1 }
                ]
            },
            {
                id: 6,
                title: "Rebirth 6",
                materials: [
                    { name: "Adena", count: 40000000 },
                    { name: "Earth Egg", count: 5 },
                    { name: "Nonliving Nucleus", count: 5 },
                    { name: "Angelic Essence", count: 5 },
                    { name: "Sword of Nightmare +6", count: 1 }
                ]
            },
            {
                id: 7,
                title: "Rebirth 7",
                materials: [
                    { name: "Adena", count: 45000000 },
                    { name: "Crafted Leather", count: 10000 },
                    { name: "Tateossian Ring +4", count: 1 },
                    { name: "Tateossian Necklace +4", count: 1 },
                    { name: "Tateossian Earring +5", count: 1 }
                ]
            },
            {
                id: 8,
                title: "Rebirth 8",
                materials: [
                    { name: "Adena", count: 50000000 },
                    { name: "Mithril Alloy", count: 1500 },
                    { name: "Durable Metal Plate", count: 1500 },
                    { name: "Broken Relic Part", count: 3000 },
                    { name: "Torch", count: 3000 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 9,
                title: "Rebirth 9",
                materials: [
                    { name: "Adena", count: 55000000 },
                    { name: "Heaven Divider +4", count: 1 },
                    { name: "Basalt Battlehammer +4", count: 1 },
                    { name: "Moonstone", count: 500 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 10,
                title: "Rebirth 10",
                materials: [
                    { name: "Adena", count: 60000000 },
                    { name: "Draconic Leather Armor +5", count: 1 },
                    { name: "Major Arcana Robe +5", count: 1 },
                    { name: "Mold Glue", count: 3500 },
                    { name: "Mold Lubricant", count: 3500 },
                    { name: "Mold Hardener", count: 3500 },
                    { name: "Musical Score - Theme of the Feast", count: 1 }
                ]
            },
            {
                id: 11,
                title: "Rebirth 11",
                materials: [
                    { name: "Adena", count: 65000000 },
                    { name: "Sword Of Miracles +5", count: 1 },
                    { name: "Soul Separator +5", count: 1 },
                    { name: "Soul Bow +5", count: 1 },
                    { name: "Recipe: Noble Elven Bow", count: 5 },
                    { name: "Recipe: Elven Bow", count: 15 }
                ]
            },
            {
                id: 12,
                title: "Rebirth 12",
                materials: [
                    { name: "Adena", count: 70000000 },
                    { name: "Recipe: Spiritshot B", count: 10 },
                    { name: "Recipe: Spiritshot A", count: 10 },
                    { name: "Recipe: Spiritshot S", count: 10 },
                    { name: "Enchant Weapon S", count: 30 },
                    { name: "Blacksmith's Frame", count: 30 },
                    { name: "Reorin's Mold", count: 30 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 13,
                title: "Rebirth 13",
                materials: [
                    { name: "Adena", count: 80000000 },
                    { name: "Sweet Fluid", count: 100 },
                    { name: "Spirit Bead", count: 1000 },
                    { name: "Warsmith Mold", count: 30 },
                    { name: "Arcsmith Anvil", count: 30 },
                    { name: "Warsmith Holder", count: 30 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 14,
                title: "Rebirth 14",
                materials: [
                    { name: "Adena", count: 100000000 },
                    { name: "Dynasty Earrings +4", count: 1 },
                    { name: "Dynasty Ring +4", count: 1 },
                    { name: "Ancient Tome Of the Demon", count: 3000 },
                    { name: "Holy Stone", count: 100 },
                    { name: "Fire Stone", count: 100 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 15,
                title: "Rebirth 15",
                materials: [
                    { name: "Adena", count: 110000000 },
                    { name: "Icarus Sawsword +4", count: 1 },
                    { name: "Arcana Mace +4", count: 1 },
                    { name: "Giant Codex", count: 100 },
                    { name: "Giant Codex - Mastery", count: 10 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 16,
                title: "Rebirth 16",
                materials: [
                    { name: "Adena", count: 120000000 },
                    { name: "Steel Bracelet", count: 1 },
                    { name: "Ertel", count: 100 },
                    { name: "Knight's Epaulette", count: 10000 },
                    { name: "Crystal S", count: 10000 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 17,
                title: "Rebirth 17",
                materials: [
                    { name: "Adena", count: 130000000 },
                    { name: "Stakato Fang", count: 3000 },
                    { name: "Green Soul Crystal Stage 4", count: 1 },
                    { name: "Crystal A", count: 10000 },
                    { name: "Orichalcum", count: 10000 },
                    { name: "Dragon Heart", count: 10 },
                    { name: "Mutagen", count: 1000 }
                ]
            },
            {
                id: 18,
                title: "Rebirth 18",
                materials: [
                    { name: "Adena", count: 150000000 },
                    { name: "Orichalcum", count: 10000 },
                    { name: "Leonard", count: 10000 },
                    { name: "Memento Mori", count: 10 },
                    { name: "Destruction Tombstone", count: 10 },
                    { name: "Event Coin", count: 6 },
                    { name: "Mutagen", count: 30 }
                ]
            },
            {
                id: 19,
                title: "Rebirth 19",
                materials: [
                    { name: "Adena", count: 170000000 },
                    { name: "Spellbook: Moirai Heavy", count: 1 },
                    { name: "Iron Ore", count: 10000 },
                    { name: "Thread", count: 10000 },
                    { name: "Scroll: 20% Spoil 20% (1h.)", count: 2 },
                    { name: "Raid Boss Cloth", count: 2 },
                    { name: "Mutagen", count: 30 }
                ]
            }
        ];

        function getSafeImageName(materialName) {
            // Mapeo manual para nombres problemáticos
            const nameMapping = {
                "Scroll EXP 20% (1 hour)": "Scroll EXP",
                "Dyes STR +1 CON -1": "Dyes",
                "Enchant Armor D": "Enchant Armor D",
                "Enchant Weapon C": "Enchant Weapon C",
                "Enchant Weapon S": "Enchant Weapon S",
                "Sword of Nightmare +6": "Sword of Nightmare +6",
                "Tateossian Ring +4": "Tateossian Ring",
                "Tateossian Necklace +4": "Tateossian Necklace",
                "Tateossian Earring +5": "Tateossian Earring",
                "Full Plate Shield +6": "Full Plate Shield +6",
                "Heaven Divider +4": "Heaven Divider",
                "Basalt Battlehammer +4": "Basalt Battlehammer",
                "Draconic Leather Armor +5": "Draconic Leather Armor",
                "Major Arcana Robe +5": "Major Arcana Robe",
                "Sword Of Miracles +5": "Sword Of Miracles",
                "Soul Separator +5": "Soul Separator",
                "Soul Bow +5": "Soul Bow",
                "Dynasty Earrings +4": "Dynasty Earrings",
                "Dynasty Ring +4": "Dynasty Ring",
                "Icarus Sawsword +4": "Icarus Sawsword",
                "Arcana Mace +4": "Arcana Mace",
                "Green Soul Crystal Stage 4": "Green Soul Crystal Stage 4",
                "Musical Score - Theme of the Feast": "Theme of the feast",
                "Recipe: Noble Elven Bow": "recipe c",
                "Recipe: Elven Bow": "recipe d",
                "Recipe: Spiritshot B": "recipe b",
                "Recipe: Spiritshot C": "recipe c",
                "Recipe: Spiritshot A": "recipe a",
                "Reorin's Mold": "Corroded Reorin Mold",
                "Recipe: Spiritshot S": "recipe",
                "Warsmith Mold": "Corroded Warsmith Mold",
                "Arcsmith Anvil": "Corroded Reorin Mold",
                "Warsmith Holder": "Corroded Reorin Mold",
                "Knight's Epaulette": "knight",
                "Raid Boss Cloth": "raid boss cloth",
                "Stem": "stem",
                "Leonard": "Leonard",
                "Memento Mori": "mori",
                "Destruction tombstone": "tomb",
                "Event Coin": "event coin",
                "Spellbook: Moirai Heavy": "moirai h",
                "Iron Ore": "Iron Ore",
                "Thread": "Thread",
                "Scroll: 20% Spoil 20% (1h.)": "Spoil 1h",
                // Agrega más mapeos según necesites
            };
                
                // Si existe en el mapeo, usa ese nombre
                if (nameMapping[materialName]) {
                    return nameMapping[materialName];
                }
                
                // Si no, usa la sanitización original
                return materialName.replace(/[\/\\?%*:|"<>]/g, '_').replace(/'/g, '');
            }

        // Iconos para los materiales de rebirth (usando el mismo sistema que la calculadora)
        function getMaterialIconForRebirth(materialName) {
            // Usar el nombre seguro para la imagen
            const safeImageName = getSafeImageName(materialName);
            const iconPath = `icons/${safeImageName}.png`;
            
            // Iconos de Font Awesome por defecto para algunos materiales
            const defaultIcons = {
                "Adena": "fa-coins",
                "Coal": "fa-cube",
                "Animal Bone": "fa-bone",
                "Animal Skin": "fa-hide",
                "Enchant Armor D": "fa-shield",
                "Dyes STR +1 CON -1": "fa-palette",
                "Enchant Weapon C": "fa-gem",
                "Scroll EXP 20% (1 hour)": "fa-scroll",
                "Stem": "fa-leaf",
                "Ritron Jelly": "fa-flask",
                "Wish Potion": "fa-wine-bottle",
                "Gold Wyvern": "fa-dragon",
                "Blood Medusa": "fa-user-ninja",
                "Silver Unicorn": "fa-horse",
                "Manticore Skin Boot Lining": "fa-shoe-prints",
                "Brigandine Helmet Design": "fa-helmet-battle",
                "Mithril Gloves Design": "fa-hand",
                "Full Plate Shield +6": "fa-shield-alt",
                "Bonebreaker head": "fa-skull",
                "Heavy Bone Club Head": "fa-hammer",
                "Earth Egg": "fa-egg",
                "Nonliving Nucleus": "fa-atom",
                "Angelic Essence": "fa-feather-alt",
                "Sword of Nightmare +6": "fa-sword",
                "Crafted Leather": "fa-scroll",
                "Tateossian Ring +4": "fa-ring",
                "Tateossian Necklace +4": "fa-gem",
                "Tateossian Earring +5": "fa-gem",
                "Mithril Alloy": "fa-cubes",
                "Durable Metal Plate": "fa-layer-group",
                "Broken Relic Part": "fa-history",
                "Torch": "fa-fire",
                "Mutagen": "fa-flask",
                "Heaven Divider +4": "fa-scissors",
                "Basalt Battlehammer +4": "fa-hammer",
                "Moonstone": "fa-moon",
                "Draconic Leather Armor +5": "fa-vest",
                "Major Arcana Robe +5": "fa-vest-patches",
                "Mold Glue": "fa-glue",
                "Mold Lubricant": "fa-oil-can",
                "Mold Hardener": "fa-gem",
                "Musical Score - Theme of the Feast": "fa-music",
                "Sword Of Miracles +5": "fa-sword",
                "Soul Separator +5": "fa-cut",
                "Soul Bow +5": "fa-bow-arrow",
                "Recipe: Noble Elven Bow": "fa-scroll",
                "Recipe: Elven Bow": "fa-scroll",
                "Recipe: Spiritshot B": "fa-scroll",
                "Recipe: Spiritshot A": "fa-scroll",
                "Recipe: Spiritshot S": "fa-scroll",
                "Enchant Weapon S": "fa-magic",
                "Blacksmith's Frame": "fa-tools",
                "Reorin's Mold": "fa-toolbox",
                "Sweet Fluid": "fa-tint",
                "Spirit Bead": "fa-circle",
                "Warsmith Mold": "fa-toolbox",
                "Arcsmith Anvil": "fa-hammer",
                "Warsmith Holder": "fa-grip",
                "Dynasty Earrings +4": "fa-gem",
                "Dynasty Ring +4": "fa-ring",
                "Ancient Tome Of the Demon": "fa-book",
                "Holy Stone": "fa-gem",
                "Fire Stone": "fa-fire",
                "Icarus Sawsword +4": "fa-sword",
                "Arcana Mace +4": "fa-hammer",
                "Giant Codex": "fa-book-open",
                "Giant Codex - Mastery": "fa-book-open",
                "Steel Bracelet": "fa-bracelet",
                "Ertel": "fa-cube",
                "Knight's Epaulette": "fa-ribbon",
                "Crystal S": "fa-gem",
                "Stakato Fang": "fa-teeth",
                "Green Soul Crystal Stage 4": "fa-gem",
                "Crystal A": "fa-gem",
                "Orichalcum": "fa-mountain",
                "Dragon Heart": "fa-heart"
            };
            
            const iconClass = defaultIcons[materialName] || "fa-cube";
            
            // Crear el elemento del icono
            const iconDiv = document.createElement('div');
            iconDiv.className = 'material-icon';
            
            const img = document.createElement('img');
            img.src = iconPath;
            img.alt = materialName;
            img.onerror = function() {
                // Si la imagen falla, reemplaza con el icono de Font Awesome
                this.parentElement.innerHTML = `<i class="fas ${iconClass}"></i>`;
            };
            
            iconDiv.appendChild(img);
            
            // Convertir a HTML string
            const tempDiv = document.createElement('div');
            tempDiv.appendChild(iconDiv.cloneNode(true));
            return tempDiv.innerHTML;
        }

        // Función para crear tarjetas de rebirth con íconos
        function createRebirthCards() {
            const container = document.getElementById('rebirthsContainer');
            container.innerHTML = '';
            
            rebirthData.forEach(rebirth => {
                const card = document.createElement('div');
                card.className = 'rebirth-card';
                
                let materialsHTML = '';
                rebirth.materials.forEach(material => {
                    materialsHTML += `
                        <div class="rebirth-material">
                            <span class="rebirth-material-name">
                                ${getMaterialIconForRebirth(material.name)}
                                ${material.name}
                            </span>
                            <span class="rebirth-material-count">${material.count.toLocaleString()}</span>
                        </div>
                    `;
                });
                
                card.innerHTML = `
                    <div class="rebirth-title">${rebirth.title}</div>
                    ${materialsHTML}
                `;
                
                container.appendChild(card);
            });
        }

        // Sistema de tabs
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remover clase active de todos los tabs
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(tc => tc.classList.remove('active'));
                    
                    // Agregar clase active al tab clickeado
                    tab.classList.add('active');
                    
                    // Mostrar el contenido correspondiente
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        // Inicializar al cargar la página
        document.addEventListener('DOMContentLoaded', () => {
            initTabs();
            createRebirthCards();
            
            // Inicializar la calculadora de armaduras
            document.getElementById("targetSelect").addEventListener("change", updateDisplay);
            document.getElementById("currentArmorSelect").addEventListener("change", updateDisplay);
            updateDisplay();
        });

        // ============================================
        // CÓDIGO DE LA CALCULADORA DE ARMADURAS
        // ============================================
        
        // Datos de las armaduras extraídos del archivo txt actualizado
        const armorData = {
            // Grado D
            "D-T1-L1": {
                name: "Grado D - Tier 1 - Lv 1",
                grade: "D",
                tier: 1,
                materials: {
                    "Ancient Adena": 15000,
                    "Leather": 180,
                    "Cord": 105,
                    "Crystal D": 240,
                    "Gemstone D": 80,
                    "Adena": 350000
                }
            },
            "D-T1-L2": {
                name: "Grado D - Tier 1 - Lv 2",
                grade: "D",
                tier: 1,
                materials: {
                    "Ancient Adena": 10000,
                    "Leather": 180,
                    "Cord": 105,
                    "Crystal D": 240,
                    "Gemstone D": 80,
                    "Adena": 350000
                }
            },
            "D-T1-L3": {
                name: "Grado D - Tier 1 - Lv 3",
                grade: "D",
                tier: 1,
                materials: {
                    "Ancient Adena": 15000,
                    "Leather": 180,
                    "Cord": 105,
                    "Crystal D": 240,
                    "Gemstone D": 80,
                    "Adena": 350000
                }
            },
            "D-T2-L1": {
                name: "Grado D - Tier 2 - Lv 1",
                grade: "D",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 1,
                    "Ancient Adena": 20000,
                    "Leather": 65,
                    "Cord": 40,
                    "Crystal D": 240,
                    "Gemstone D": 80,
                    "Adena": 350000
                }
            },
            "D-T2-L2": {
                name: "Grado D - Tier 2 - Lv 2",
                grade: "D",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 1,
                    "Ancient Adena": 25000,
                    "Leather": 65,
                    "Cord": 40,
                    "Crystal D": 240,
                    "Gemstone D": 80,
                    "Adena": 350000
                }
            },
            "D-T2-L3": {
                name: "Grado D - Tier 2 - Lv 3",
                grade: "D",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 1,
                    "Ancient Adena": 30000,
                    "Leather": 65,
                    "Cord": 40,
                    "Crystal D": 240,
                    "Gemstone D": 80,
                    "Adena": 350000
                }
            },
            // Grado C
            "C-T1-L1": {
                name: "Grado C - Tier 1 - Lv 1",
                grade: "C",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 1,
                    "Mutagen": 7,
                    "Ancient Adena": 100000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 90,
                    "High-grade Suede": 24,
                    "Blacksmith's Frame": 2,
                    "Crystal C": 150,
                    "Gemstone C": 50,
                    "Adena": 3200000
                }
            },
            "C-T1-L2": {
                name: "Grado C - Tier 1 - Lv 2",
                grade: "C",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 1,
                    "Mutagen": 7,
                    "Ancient Adena": 150000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 90,
                    "High-grade Suede": 24,
                    "Blacksmith's Frame": 2,
                    "Crystal C": 150,
                    "Gemstone C": 50,
                    "Adena": 3200000
                }
            },
            "C-T1-L3": {
                name: "Grado C - Tier 1 - Lv 3",
                grade: "C",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 1,
                    "Mutagen": 7,
                    "Ancient Adena": 200000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 90,
                    "High-grade Suede": 24,
                    "Blacksmith's Frame": 2,
                    "Crystal C": 150,
                    "Gemstone C": 50,
                    "Adena": 3200000
                }
            },
            "C-T2-L1": {
                name: "Grado C - Tier 2 - Lv 1",
                grade: "C",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 2,
                    "Mutagen": 7,
                    "Ancient Adena": 250000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 90,
                    "High-grade Suede": 25,
                    "Blacksmith's Frame": 3,
                    "Crystal C": 250,
                    "Gemstone C": 100,
                    "Adena": 3200000
                }
            },
            "C-T2-L2": {
                name: "Grado C - Tier 2 - Lv 2",
                grade: "C",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 2,
                    "Mutagen": 7,
                    "Ancient Adena": 300000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 90,
                    "High-grade Suede": 25,
                    "Blacksmith's Frame": 3,
                    "Crystal C": 250,
                    "Gemstone C": 100,
                    "Adena": 3200000
                }
            },
            "C-T2-L3": {
                name: "Grado C - Tier 2 - Lv 3",
                grade: "C",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 2,
                    "Mutagen": 7,
                    "Ancient Adena": 350000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 90,
                    "High-grade Suede": 25,
                    "Blacksmith's Frame": 3,
                    "Crystal C": 250,
                    "Gemstone C": 100,
                    "Adena": 4000000
                }
            },
            "C-T3-L1": {
                name: "Grado C - Tier 3 - Lv 1",
                grade: "C",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 2,
                    "Mutagen": 7,
                    "Ancient Adena": 350000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 55,
                    "High-grade Suede": 25,
                    "Blacksmith's Frame": 4,
                    "Crystal C": 350,
                    "Gemstone C": 150,
                    "Adena": 4000000
                }
            },
            "C-T3-L2": {
                name: "Grado C - Tier 3 - Lv 2",
                grade: "C",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 2,
                    "Mutagen": 7,
                    "Ancient Adena": 350000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 55,
                    "High-grade Suede": 25,
                    "Blacksmith's Frame": 4,
                    "Crystal C": 350,
                    "Gemstone C": 150,
                    "Adena": 4000000
                }
            },
            "C-T3-L3": {
                name: "Grado C - Tier 3 - Lv 3",
                grade: "C",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 2,
                    "Mutagen": 7,
                    "Ancient Adena": 350000,
                    "Quality Leather": 180,
                    "Synthetic Braid": 180,
                    "Metallic Fiber": 55,
                    "High-grade Suede": 25,
                    "Blacksmith's Frame": 4,
                    "Crystal C": 350,
                    "Gemstone C": 150,
                    "Adena": 4000000
                }
            },
            // Grado B
            "B-Zubei-L1": {
                name: "Grado B - Zubei - Lv 1",
                grade: "B",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 4,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 8000000
                }
            },
            "B-Zubei-L2": {
                name: "Grado B - Zubei - Lv 2",
                grade: "B",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 4,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 8000000
                }
            },
            "B-Zubei-L3": {
                name: "Grado B - Zubei - Lv 3",
                grade: "B",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 4,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 8000000
                }
            },
            "B-Avadon-L1": {
                name: "Grado B - Avadon - Lv 1",
                grade: "B",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 5,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 8500000
                }
            },
            "B-Avadon-L2": {
                name: "Grado B - Avadon - Lv 2",
                grade: "B",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 5,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 8500000
                }
            },
            "B-Avadon-L3": {
                name: "Grado B - Avadon - Lv 3",
                grade: "B",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 5,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 8500000
                }
            },
            "B-BlueWolf-L1": {
                name: "Grado B - Blue Wolf - Lv 1",
                grade: "B",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 6,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 9000000
                }
            },
            "B-BlueWolf-L2": {
                name: "Grado B - Blue Wolf - Lv 2",
                grade: "B",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 6,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 9000000
                }
            },
            "B-BlueWolf-L3": {
                name: "Grado B - Blue Wolf - Lv 3",
                grade: "B",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 6,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 9000000
                }
            },
            "B-Doom-L1": {
                name: "Grado B - Doom - Lv 1",
                grade: "B",
                tier: 4,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 7,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 10500000
                }
            },
            "B-Doom-L2": {
                name: "Grado B - Doom - Lv 2",
                grade: "B",
                tier: 4,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 7,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 10500000
                }
            },
            "B-Doom-L3": {
                name: "Grado B - Doom - Lv 3",
                grade: "B",
                tier: 4,
                materials: {
                    "Raid Boss Cloth": 3,
                    "Mutagen": 14,
                    "Ancient Adena": 350000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 7,
                    "Gemstone B": 45,
                    "Crystal B": 85,
                    "Adena": 10500000
                }
            },
            // Grado A
            "A-DarkCrystal-L1": {
                name: "Grado A - Dark Crystal - Lv 1",
                grade: "A",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 4,
                    "Mutagen": 14,
                    "Ancient Adena": 400000,
                    "Quality Leather": 250,
                    "Synthetic Braid": 250,
                    "Metallic Fiber": 180,
                    "Asofe": 180,
                    "Blacksmith's Frame": 7,
                    "Gemstone B": 45,
                    "Crystal B": 95,
                    "Adena": 16000000
                }
            },
            "A-DarkCrystal-L2": {
                name: "Grado A - Dark Crystal - Lv 2",
                grade: "A",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 3,
                    "Maestro Anvil Lock": 2,
                    "Quality Leather": 450,
                    "Metallic Fiber": 120,
                    "Synthetic Braid": 80,
                    "Asofe": 200,
                    "High-grade Suede": 24,
                    "Gemstone A": 35,
                    "Crystal A": 110,
                    "Adena": 15000000
                }
            },
            "A-DarkCrystal-L3": {
                name: "Grado A - Dark Crystal - Lv 3",
                grade: "A",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 3,
                    "Maestro Anvil Lock": 2,
                    "Quality Leather": 450,
                    "Metallic Fiber": 120,
                    "Synthetic Braid": 80,
                    "Asofe": 200,
                    "High-grade Suede": 24,
                    "Gemstone A": 35,
                    "Crystal A": 110,
                    "Adena": 15000000
                }
            },
            "A-Tallum-L1": {
                name: "Grado A - Tallum - Lv 1",
                grade: "A",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 6,
                    "Maestro Anvil Lock": 4,
                    "Quality Leather": 350,
                    "Metallic Fiber": 100,
                    "Synthetic Braid": 80,
                    "Asofe": 208,
                    "High-grade Suede": 60,
                    "Gemstone A": 45,
                    "Crystal A": 125,
                    "Adena": 20000000
                }
            },
            "A-Tallum-L2": {
                name: "Grado A - Tallum - Lv 2",
                grade: "A",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 6,
                    "Maestro Anvil Lock": 4,
                    "Quality Leather": 350,
                    "Metallic Fiber": 100,
                    "Synthetic Braid": 80,
                    "Asofe": 208,
                    "High-grade Suede": 60,
                    "Gemstone A": 45,
                    "Crystal A": 125,
                    "Adena": 20000000
                }
            },
            "A-Tallum-L3": {
                name: "Grado A - Tallum - Lv 3",
                grade: "A",
                tier: 2,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 6,
                    "Maestro Anvil Lock": 4,
                    "Quality Leather": 350,
                    "Metallic Fiber": 100,
                    "Synthetic Braid": 80,
                    "Asofe": 208,
                    "High-grade Suede": 60,
                    "Gemstone A": 45,
                    "Crystal A": 125,
                    "Adena": 20000000
                }
            },
            "A-Nightmare-L1": {
                name: "Grado A - Nightmare - Lv 1",
                grade: "A",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 9,
                    "Maestro Anvil Lock": 6,
                    "Quality Leather": 190,
                    "Metallic Fiber": 56,
                    "Synthetic Braid": 48,
                    "Asofe": 120,
                    "High-grade Suede": 36,
                    "Gemstone A": 60,
                    "Crystal A": 140,
                    "Adena": 12500000
                }
            },
            "A-Nightmare-L2": {
                name: "Grado A - Nightmare - Lv 2",
                grade: "A",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 9,
                    "Maestro Anvil Lock": 6,
                    "Quality Leather": 190,
                    "Metallic Fiber": 56,
                    "Synthetic Braid": 48,
                    "Asofe": 120,
                    "High-grade Suede": 36,
                    "Gemstone A": 60,
                    "Crystal A": 140,
                    "Adena": 12500000
                }
            },
            "A-Nightmare-L3": {
                name: "Grado A - Nightmare - Lv 3",
                grade: "A",
                tier: 3,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 9,
                    "Maestro Anvil Lock": 6,
                    "Quality Leather": 190,
                    "Metallic Fiber": 56,
                    "Synthetic Braid": 48,
                    "Asofe": 120,
                    "High-grade Suede": 36,
                    "Gemstone A": 60,
                    "Crystal A": 140,
                    "Adena": 12500000
                }
            },
            "A-Majestic-L1": {
                name: "Grado A - Majestic - Lv 1",
                grade: "A",
                tier: 4,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 12,
                    "Maestro Anvil Lock": 8,
                    "Quality Leather": 185,
                    "Metallic Fiber": 62,
                    "Synthetic Braid": 54,
                    "Asofe": 135,
                    "High-grade Suede": 42,
                    "Gemstone A": 77,
                    "Crystal A": 155,
                    "Adena": 15000000
                }
            },
            "A-Majestic-L2": {
                name: "Grado A - Majestic - Lv 2",
                grade: "A",
                tier: 4,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 12,
                    "Maestro Anvil Lock": 8,
                    "Quality Leather": 185,
                    "Metallic Fiber": 62,
                    "Synthetic Braid": 54,
                    "Asofe": 135,
                    "High-grade Suede": 42,
                    "Gemstone A": 77,
                    "Crystal A": 155,
                    "Adena": 15000000
                }
            },
            "A-Majestic-L3": {
                name: "Grado A - Majestic - Lv 3",
                grade: "A",
                tier: 4,
                materials: {
                    "Raid Boss Cloth": 5,
                    "Mutagen": 70,
                    "Ancient Adena": 450000,
                    "Maestro Mold": 12,
                    "Maestro Anvil Lock": 8,
                    "Quality Leather": 185,
                    "Metallic Fiber": 62,
                    "Synthetic Braid": 54,
                    "Asofe": 135,
                    "High-grade Suede": 42,
                    "Gemstone A": 77,
                    "Crystal A": 155,
                    "Adena": 15000000
                }
            },
            // Grado S
            "S-L1": {
                name: "Grado S - Lv 1",
                grade: "S",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 10,
                    "Mutagen": 70,
                    "Ancient Adena": 1000000,
                    "Corroed Arcsmith Anvil": 5,
                    "Corroded Reorin Mold": 13,
                    "Corroded Warsmith Mold": 26,
                    "Metallic Fiber": 690,
                    "Quality Leather": 690,
                    "Synthetic Braid": 460,
                    "Asofe": 1140,
                    "Gemstone S": 26,
                    "Crystal S": 150,
                    "Adena": 190000000
                }
            },
            "S-L2": {
                name: "Grado S - Lv 2",
                grade: "S",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 10,
                    "Mutagen": 70,
                    "Ancient Adena": 1000000,
                    "Corroed Arcsmith Anvil": 5,
                    "Corroded Reorin Mold": 13,
                    "Corroded Warsmith Mold": 26,
                    "Metallic Fiber": 690,
                    "Quality Leather": 690,
                    "Synthetic Braid": 460,
                    "Asofe": 1140,
                    "Gemstone S": 26,
                    "Crystal S": 150,
                    "Adena": 190000000
                }
            },
            "S-L3": {
                name: "Grado S - Lv 3",
                grade: "S",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 10,
                    "Mutagen": 70,
                    "Ancient Adena": 1000000,
                    "Corroed Arcsmith Anvil": 5,
                    "Corroded Reorin Mold": 13,
                    "Corroded Warsmith Mold": 26,
                    "Metallic Fiber": 690,
                    "Quality Leather": 690,
                    "Synthetic Braid": 460,
                    "Asofe": 1140,
                    "Gemstone S": 26,
                    "Crystal S": 150,
                    "Adena": 190000000
                }
            },
            // Grado Dynasty
            "Dynasty-L1": {
                name: "Grado Dynasty - Lv 1",
                grade: "Dynasty",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 10,
                    "Mutagen": 78,
                    "Ancient Adena": 1000000,
                    "Corroded Reorin Mold": 28,
                    "Corroded Warsmith Mold": 26,
                    "Metallic Fiber": 890,
                    "Quality Leather": 3690,
                    "Orichalcum": 544,
                    "Asofe": 1490,
                    "High-grade Suede": 340,
                    "Gemstone S": 29,
                    "Crystal S": 146,
                    "Adena": 480000000
                }
            },
            "Dynasty-L2": {
                name: "Grado Dynasty - Lv 2",
                grade: "Dynasty",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 10,
                    "Mutagen": 78,
                    "Ancient Adena": 1200000,
                    "Corroded Reorin Mold": 39,
                    "Corroded Warsmith Mold": 26,
                    "Metallic Fiber": 1200,
                    "Quality Leather": 5380,
                    "Orichalcum": 799,
                    "Asofe": 1638,
                    "High-grade Suede": 680,
                    "Gemstone S": 33,
                    "Crystal S": 145,
                    "Adena": 500000000
                }
            },
            "Dynasty-L3": {
                name: "Grado Dynasty - Lv 3",
                grade: "Dynasty",
                tier: 1,
                materials: {
                    "Raid Boss Cloth": 10,
                    "Mutagen": 78,
                    "Ancient Adena": 1200000,
                    "Corroded Reorin Mold": 39,
                    "Corroded Warsmith Mold": 26,
                    "Metallic Fiber": 1200,
                    "Quality Leather": 5380,
                    "Orichalcum": 799,
                    "Asofe": 1638,
                    "High-grade Suede": 680,
                    "Gemstone S": 33,
                    "Crystal S": 145,
                    "Adena": 500000000
                }
            },
            // Datos de las piezas individuales de Moirai para usar en el cálculo
            "Moirai-Helmet": {
                name: "Moirai Helmet",
                grade: "Moirai",
                tier: 1,
                materials: {
                    "Recipe Moirai Helmet": 3,
                    "Raid Boss Cloth": 6,
                    "Mutagen": 45,
                    "Ancient Adena": 900000,
                    "Corroded Reorin Mold": 18,
                    "Quality Leather": 2080,
                    "Orichalcum": 200,
                    "Asofe": 308,
                    "Gemstone S": 27,
                    "Crystal S": 362,
                    "Adena": 300000000
                }
            },
            "Moirai-Armor": {
                name: "Moirai Armor",
                grade: "Moirai",
                tier: 2,
                materials: {
                    "Recipe Moirai Armor": 3,
                    "Raid Boss Cloth": 6,
                    "Mutagen": 45,
                    "Ancient Adena": 900000,
                    "Corroded Reorin Mold": 18,
                    "Metallic Fiber": 2000,
                    "Quality Leather": 3000,
                    "Orichalcum": 400,
                    "Asofe": 700,
                    "Gemstone S": 57,
                    "Crystal S": 930,
                    "Adena": 300000000
                }
            },
            "Moirai-Pants": {
                name: "Moirai Pants",
                grade: "Moirai",
                tier: 3,
                materials: {
                    "Recipe Moirai Pants": 3,
                    "Raid Boss Cloth": 6,
                    "Mutagen": 45,
                    "Ancient Adena": 900000,
                    "Corroded Reorin Mold": 18,
                    "Metallic Fiber": 2000,
                    "Quality Leather": 3000,
                    "Orichalcum": 400,
                    "Asofe": 700,
                    "Gemstone S": 57,
                    "Crystal S": 930,
                    "Adena": 300000000
                }
            },
            "Moirai-Glove": {
                name: "Moirai Glove",
                grade: "Moirai",
                tier: 4,
                materials: {
                    "Recipe Moirai Glove": 3,
                    "Raid Boss Cloth": 6,
                    "Mutagen": 45,
                    "Ancient Adena": 900000,
                    "Corroded Warsmith Mold": 18,
                    "Quality Leather": 1420,
                    "High-grade Suede": 552,
                    "Orichalcum": 150,
                    "Asofe": 200,
                    "Gemstone S": 18,
                    "Crystal S": 311,
                    "Adena": 300000000
                }
            },
            "Moirai-Shoes": {
                name: "Moirai Shoes",
                grade: "Moirai",
                tier: 5,
                materials: {
                    "Recipe Moirai Shoes": 3,
                    "Raid Boss Cloth": 6,
                    "Mutagen": 45,
                    "Ancient Adena": 900000,
                    "Corroded Warsmith Mold": 18,
                    "Quality Leather": 1420,
                    "High-grade Suede": 552,
                    "Orichalcum": 150,
                    "Asofe": 200,
                    "Gemstone S": 18,
                    "Crystal S": 311,
                    "Adena": 300000000
                }
            },
            // Set Moirai completo (combinación de las 5 piezas)
            "moirai-full": {
                name: "Set Moirai Completo",
                grade: "Moirai",
                tier: 1,
                materials: {
                    "Recipe Moirai Helmet": 3,
                    "Recipe Moirai Armor": 3,
                    "Recipe Moirai Pants": 3,
                    "Recipe Moirai Glove": 3,
                    "Recipe Moirai Shoes": 3,
                    "Raid Boss Cloth": 30,
                    "Mutagen": 225,
                    "Ancient Adena": 4500000,
                    "Corroded Reorin Mold": 54,
                    "Corroded Warsmith Mold": 36,
                    "Quality Leather": 2080 + 3000 + 3000 + 1420 + 1420,
                    "Metallic Fiber": 4000,
                    "Orichalcum": 200 + 400 + 400 + 150 + 150,
                    "Asofe": 308 + 700 + 700 + 200 + 200,
                    "High-grade Suede": 1104,
                    "Gemstone S": 27 + 57 + 57 + 18 + 18,
                    "Crystal S": 362 + 930 + 930 + 311 + 311,
                    "Adena": 1500000000
                }
            }
        };

        // Orden de progresión de armaduras
        const armorProgression = [
            // Grado D
            "D-T1-L1", "D-T1-L2", "D-T1-L3",
            "D-T2-L1", "D-T2-L2", "D-T2-L3",
            // Grado C
            "C-T1-L1", "C-T1-L2", "C-T1-L3",
            "C-T2-L1", "C-T2-L2", "C-T2-L3",
            "C-T3-L1", "C-T3-L2", "C-T3-L3",
            // Grado B
            "B-Zubei-L1", "B-Zubei-L2", "B-Zubei-L3",
            "B-Avadon-L1", "B-Avadon-L2", "B-Avadon-L3",
            "B-BlueWolf-L1", "B-BlueWolf-L2", "B-BlueWolf-L3",
            "B-Doom-L1", "B-Doom-L2", "B-Doom-L3",
            // Grado A
            "A-DarkCrystal-L1", "A-DarkCrystal-L2", "A-DarkCrystal-L3",
            "A-Tallum-L1", "A-Tallum-L2", "A-Tallum-L3",
            "A-Nightmare-L1", "A-Nightmare-L2", "A-Nightmare-L3",
            "A-Majestic-L1", "A-Majestic-L2", "A-Majestic-L3",
            // Grado S
            "S-L1", "S-L2", "S-L3",
            // Grado Dynasty
            "Dynasty-L1", "Dynasty-L2", "Dynasty-L3",
            // Grado Moirai (las 5 piezas juntas como un set completo)
            "moirai-full"
        ];

        // Iconos por defecto para materiales (Font Awesome) - ACTUALIZADO para incluir Recipes
        const materialIcons = {
            "Adena": "fa-coins",
            "Ancient Adena": "fa-gem",
            "Leather": "fa-scroll",
            "Cord": "fa-rope",
            "Crystal D": "fa-gem",
            "Gemstone D": "fa-gem",
            "Crystal C": "fa-gem",
            "Gemstone C": "fa-gem",
            "Crystal B": "fa-gem",
            "Gemstone B": "fa-gem",
            "Crystal A": "fa-gem",
            "Gemstone A": "fa-gem",
            "Crystal S": "fa-gem",
            "Gemstone S": "fa-gem",
            "Raid Boss Cloth": "fa-scroll",
            "Mutagen": "fa-flask",
            "Quality Leather": "fa-scroll",
            "Synthetic Braid": "fa-braille",
            "Metallic Fiber": "fa-link",
            "High-grade Suede": "fa-feather",
            "Blacksmith's Frame": "fa-tools",
            "Asofe": "fa-shield",
            "Maestro Mold": "fa-toolbox",
            "Maestro Anvil Lock": "fa-lock",
            "Corroed Arcsmith Anvil": "fa-hammer",
            "Corroded Reorin Mold": "fa-toolbox",
            "Corroded Warsmith Mold": "fa-toolbox",
            "Orichalcum": "fa-mountain",
            "Recipe Moirai Helmet": "fa-scroll",
            "Recipe Moirai Armor": "fa-scroll", 
            "Recipe Moirai Pants": "fa-scroll",
            "Recipe Moirai Glove": "fa-scroll",
            "Recipe Moirai Shoes": "fa-scroll"
        };

        // Función para obtener el icono de un material - MEJORADA para Recipes
        function getMaterialIcon(materialName) {
            // Para los Recipes Moirai, usar siempre recipe.png
            if (materialName.includes("Recipe Moirai")) {
                const iconPath = `icons/recipe.png`;
                
                const iconDiv = document.createElement('div');
                iconDiv.className = 'material-icon';
                
                const img = document.createElement('img');
                img.src = iconPath;
                img.alt = materialName;
                img.onerror = function() {
                    this.parentElement.innerHTML = `<i class="fas fa-scroll"></i>`;
                };
                
                iconDiv.appendChild(img);
                
                const tempDiv = document.createElement('div');
                tempDiv.appendChild(iconDiv.cloneNode(true));
                return tempDiv.innerHTML;
            }
            
            // Para otros materiales, seguir el proceso normal
            const safeMaterialName = materialName.replace(/[\/\\?%*:|"<>]/g, '_').replace(/'/g, '');
            const iconPath = `icons/${safeMaterialName}.png`;
            
            const iconClass = materialIcons[materialName] || "fa-cube";
            
            const iconDiv = document.createElement('div');
            iconDiv.className = 'material-icon';
            
            const img = document.createElement('img');
            img.src = iconPath;
            img.alt = materialName;
            img.onerror = function() {
                this.parentElement.innerHTML = `<i class="fas ${iconClass}"></i>`;
            };
            
            iconDiv.appendChild(img);
            
            const tempDiv = document.createElement('div');
            tempDiv.appendChild(iconDiv.cloneNode(true));
            return tempDiv.innerHTML;
        }

        // Función para obtener los materiales necesarios según objetivo y armadura actual
        function calculateMaterials(target, currentArmor) {
            const totalMaterials = {};
            const gradeTotals = {};
            const gradeArmorCount = {};
            
            // Encontrar el índice de la armadura actual en la progresión
            let startIndex = 0;
            if (currentArmor !== "none") {
                startIndex = armorProgression.indexOf(currentArmor) + 1;
                if (startIndex === 0) startIndex = 0;
            }
            
            // Determinar el índice final según el objetivo
            let endIndex = armorProgression.length;
            if (target === "grade-d") {
                endIndex = 6;
            } else if (target === "grade-c") {
                endIndex = 15;
            } else if (target === "grade-b") {
                endIndex = 27;
            } else if (target === "grade-a") {
                endIndex = 39;
            } else if (target === "grade-s") {
                endIndex = 42;
            } else if (target === "grade-dynasty") {
                endIndex = 45;
            } else if (target === "grade-moirai") {
                endIndex = 46;
            }
            
            // Sumar materiales de todas las armaduras en el rango
            for (let i = startIndex; i < endIndex; i++) {
                const armorKey = armorProgression[i];
                const armor = armorData[armorKey];
                const grade = armor.grade;
                
                // Contar armaduras por grado
                if (armorKey === "moirai-full") {
                    gradeArmorCount[grade] = (gradeArmorCount[grade] || 0) + 1;
                } else {
                    gradeArmorCount[grade] = (gradeArmorCount[grade] || 0) + 1;
                }
                
                // Inicializar el total por grado si no existe
                if (!gradeTotals[grade]) {
                    gradeTotals[grade] = {};
                }
                
                // Sumar materiales
                for (const [material, quantity] of Object.entries(armor.materials)) {
                    totalMaterials[material] = (totalMaterials[material] || 0) + quantity;
                    gradeTotals[grade][material] = (gradeTotals[grade][material] || 0) + quantity;
                }
            }
            
            return { totalMaterials, gradeTotals, gradeArmorCount, startIndex, endIndex };
        }

        // Función para crear una tabla de materiales
        function createMaterialTable(materials, title, gradeClass) {
            const sortedMaterials = Object.entries(materials).sort((a, b) => a[0].localeCompare(b[0]));
            
            let adenaTotal = 0;
            let ancientAdenaTotal = 0;
            let otherMaterials = [];
            
            for (const [material, quantity] of sortedMaterials) {
                if (material === "Adena") {
                    adenaTotal = quantity;
                } else if (material === "Ancient Adena") {
                    ancientAdenaTotal = quantity;
                } else {
                    otherMaterials.push([material, quantity]);
                }
            }
            
            let html = `
                <div class="table-container">
                    <h3 class="${gradeClass}">${title}</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Material</th>
                                <th>Cantidad Total</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            if (adenaTotal > 0) {
                html += `
                    <tr>
                        <td>
                            <div class="material-cell">
                                ${getMaterialIcon("Adena")}
                                <span class="material-name">Adena</span>
                            </div>
                        </td>
                        <td class="material-count">${adenaTotal.toLocaleString()}</td>
                    </tr>
                `;
            }
            
            if (ancientAdenaTotal > 0) {
                html += `
                    <tr>
                        <td>
                            <div class="material-cell">
                                ${getMaterialIcon("Ancient Adena")}
                                <span class="material-name">Ancient Adena</span>
                            </div>
                        </td>
                        <td class="material-count">${ancientAdenaTotal.toLocaleString()}</td>
                    </tr>
                `;
            }
            
            for (const [material, quantity] of otherMaterials) {
                html += `
                    <tr>
                        <td>
                            <div class="material-cell">
                                ${getMaterialIcon(material)}
                                <span class="material-name">${material}</span>
                            </div>
                        </td>
                        <td class="material-count">${quantity.toLocaleString()}</td>
                    </tr>
                `;
            }
            
            const totalItems = Object.keys(materials).length;
            if (totalItems > 0) {
                html += `
                    <tr class="total-row">
                        <td class="material-name">Total de materiales diferentes</td>
                        <td class="material-count">${totalItems}</td>
                    </tr>
                `;
            }
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            return html;
        }

        // Función para crear el resumen por grado
        function createGradeSummary(gradeTotals, gradeArmorCount) {
            const gradeOrder = ["D", "C", "B", "A", "S", "Dynasty", "Moirai"];
            let html = '';
            
            for (const grade of gradeOrder) {
                if (gradeTotals[grade] && Object.keys(gradeTotals[grade]).length > 0) {
                    const armorCount = gradeArmorCount[grade] || 0;
                    const materialCount = Object.keys(gradeTotals[grade]).length;
                    let adenaTotal = gradeTotals[grade]["Adena"] || 0;
                    let ancientAdenaTotal = gradeTotals[grade]["Ancient Adena"] || 0;
                    
                    html += `
                        <div class="grade-card ${grade.toLowerCase()}">
                            <div class="grade-title">Grado ${grade}</div>
                            <div class="grade-stats">
                                <div><i class="fas fa-shield-alt"></i> Armaduras: ${armorCount}</div>
                                <div><i class="fas fa-cube"></i> Materiales: ${materialCount}</div>
                                <div><i class="fas fa-coins"></i> Adena: ${adenaTotal.toLocaleString()}</div>
                                ${ancientAdenaTotal > 0 ? `<div><i class="fas fa-gem"></i> Ancient Adena: ${ancientAdenaTotal.toLocaleString()}</div>` : ''}
                            </div>
                        </div>
                    `;
                }
            }
            
            return html;
        }

        // Función para actualizar la visualización
        function updateDisplay() {
            const target = document.getElementById("targetSelect").value;
            const currentArmor = document.getElementById("currentArmorSelect").value;
            
            const resultsContainer = document.getElementById("resultsContainer");
            const summaryContainer = document.getElementById("summaryContainer");
            
            resultsContainer.innerHTML = "";
            summaryContainer.innerHTML = "";
            
            const { totalMaterials, gradeTotals, gradeArmorCount } = calculateMaterials(target, currentArmor);
            
            // Mostrar resumen por grado
            summaryContainer.innerHTML = createGradeSummary(gradeTotals, gradeArmorCount);
            
            // Mostrar tablas por grado
            const gradeOrder = ["D", "C", "B", "A", "S", "Dynasty", "Moirai"];
            
            for (const grade of gradeOrder) {
                if (gradeTotals[grade] && Object.keys(gradeTotals[grade]).length > 0) {
                    const gradeClass = `grade-${grade.toLowerCase()}`;
                    let gradeTitle = `Grado ${grade} - Materiales Totales`;
                    
                    if (grade === "B") gradeTitle += " (Zubei, Avadon, Blue Wolf, Doom)";
                    if (grade === "A") gradeTitle += " (Dark Crystal, Tallum, Nightmare, Majestic)";
                    if (grade === "Moirai") gradeTitle += " (Set completo: Helmet, Armor, Pants, Glove, Shoes)";
                    
                    resultsContainer.innerHTML += createMaterialTable(gradeTotals[grade], gradeTitle, gradeClass);
                }
            }
            
            // Mostrar tabla con total general
            if (Object.keys(totalMaterials).length > 0) {
                resultsContainer.innerHTML += createMaterialTable(totalMaterials, "TOTAL GENERAL - Todos los materiales", "grade-all");
            }
        }
    </script>
</body>
</html>
